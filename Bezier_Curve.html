<HTML>
<meta charset="UTF-8">
<p>Сначала левой кнопкой мыши строятся точки,
    по нажатию правой достраивается последний линия.
</p>
<BODY>
<canvas id='homework06' width='400px' height='400px' style='border:20px groove #8bb1c4'>
</canvas>
<script>

    function getBezierBasis(i, n, t) {
        function f(n) {
            return (n <= 1) ? 1 : n * f(n - 1);
        }
        return (f(n) / (f(i) * f(n - i))) * Math.pow(t, i) * Math.pow(1 - t, n - i);
    }


    function getBezierCurve(arr, step) {

        const res = [];

        for (let t = 0; t < 1 + step; t += step) {
            if (t > 1) {
                t = 1;
            }

            const ind = res.length;

            res[ind] = [0, 0];

            for (let i = 0; i < arr.length; i++) {
                const b = getBezierBasis(i, arr.length - 1, t);

                res[ind][0] += arr[i][0] * b;
                res[ind][1] += arr[i][1] * b;
            }
        }

        return res;
    }


    function Line(ctx, xstart, ystart, xend, yend, color){
        ctx.fillStyle = color;
        let dmax = Math.max(Math.abs(xend - xstart), Math.abs(yend - ystart));
        let dmin = Math.min(Math.abs(xend - xstart), Math.abs(yend - ystart));
        let xdir = 1;
        if (xend < xstart) xdir = -1;
        let ydir = 1;
        if (yend < ystart) ydir = -1;
        let eps = 0;
        let s = 1;
        let k = 2 * dmin;
        if (Math.abs(yend - ystart) <= Math.abs(xend - xstart)) {
            let y = ystart;
            for (let x = xstart; x * xdir <= xend * xdir; x += xdir) {
                ctx.fillRect(x * s, y * s, s, s);
                eps = eps + k;
                if (eps > dmax) {
                    y += ydir;
                    eps = eps - 2 * dmax;
                }
            }
        } else {
            let x = xstart;
            for (let y = ystart; y * ydir <= yend * ydir; y += ydir) {
                ctx.fillRect(x * s, y * s, s, s);
                eps = eps + k;
                if (eps > dmax) {
                    x += xdir;
                    eps = eps - 2 * dmax;
                }
            }
        }
    }

</script>
<script>
    const canvas = document.getElementById("homework06");
    const ctx = canvas.getContext("2d");

    let x = 0;
    let y = 0;
    const arr = [];

    canvas.addEventListener("click", function (event) {
        x = event.offsetX
        y = event.offsetY
        arr.push([x, y])
        ctx.beginPath()
        ctx.arc(x, y, 3, 0, 2 * Math.PI, false);
        ctx.fill()

    });

    canvas.addEventListener('contextmenu', function (event) {
        ctx.lineWidth = 0.1;

        let flow;
        flow = getBezierCurve(arr, 0.01);
        for (let i = 0; i < flow.length; i += 1) {
            Line(ctx, flow[i][0], flow[i][1], flow[i + 1][0], flow[i + 1][1])
        }
    });

</script>
</BODY>
</HTML>
